# ============================================================
# PILOT CPLD - OpenOCD JTAG Programmer Configuration
# Device: Altera MAX V 5M80ZT100C5
# ============================================================
#
# DOĞRU GPIO BAĞLANTILARI (Fiziksel Pinlerden Analiz):
#
# Raspberry Pi 40-Pin Header:
#   Pin 15 (GPIO 22) -> Altera PIN 33 (TMS)
#   Pin 22 (GPIO 27) -> Altera PIN 34 (TDI)  ← YANLIŞ OLANDI!
#   Pin 23 (GPIO 24) -> Altera PIN 36 (TDO)
#   Pin 16 (GPIO 23) -> Altera PIN 35 (TCK)  ← YANLIŞ OLANDI!
#
# ============================================================

# Raspberry Pi GPIO interface (Linux gpiochip)
adapter driver bcm2835gpio

# BCM2835 GPIO base address (Raspberry Pi 4 için)
bcm2835gpio peripheral_base 0xFE000000

# GPIO pin mapping - DÜZELTILMIŞ!
bcm2835gpio jtag_nums 22 27 24 23
# Sıralama: TMS TDI TDO TCK

# JTAG hızı (100 kHz - güvenli başlangıç)
adapter speed 100

# JTAG transport
transport select jtag

# Altera MAX V 5M80ZT100C5 TAP tanımı
jtag newtap maxv tap -irlen 10 -expected-id 0x020a10dd

# Initialization
init

echo "============================================================"
echo "  CPLD JTAG BAĞLANTISI HAZIR"
echo "  Cihaz: Altera MAX V 5M80ZT100C5"
echo "============================================================"
echo ""
echo "GPIO Eşlemesi (DÜZELTILMIŞ):"
echo "  GPIO 22 (Pin 15) -> TMS (Altera PIN 33)"
echo "  GPIO 27 (Pin 22) -> TDI (Altera PIN 34)"
echo "  GPIO 24 (Pin 23) -> TDO (Altera PIN 36)"
echo "  GPIO 23 (Pin 16) -> TCK (Altera PIN 35)"
echo ""
