# ============================================================
# PILOT CPLD - OpenOCD JTAG Configuration (FINAL CORRECT)
# Device: Altera MAX V 5M80ZT100C5
# ============================================================
#
# DOĞRU BAĞLANTILAR (Fiziksel Karttan):
#
# Raspberry Pi 40-Pin Header -> CPLD:
#   Pin 16 (GPIO 23) -> Altera PIN 33 (TMS)
#   Pin 15 (GPIO 22) -> Altera PIN 34 (TDI)
#   Pin 22 (GPIO 25) -> Altera PIN 35 (TCK)
#   Pin 18 (GPIO 24) -> Altera PIN 36 (TDO)
#   Pin 6  (GND)     -> GND
#
# ÖNEMLİ: Pin 12 (Altera PIN25 VCCIO1) harici güçten besleniyor!
#
# ============================================================

# Raspberry Pi BCM2835 GPIO interface
adapter driver bcm2835gpio

# BCM2835 GPIO peripheral base (Raspberry Pi 4)
bcm2835gpio_peripheral_base 0xFE000000

# JTAG GPIO mapping - FINAL CORRECT VERSION
# Format: TMS TDI TDO TCK
bcm2835gpio_jtag_nums 23 22 24 25

# JTAG speed (100 kHz for safety)
adapter speed 100

# JTAG transport
transport select jtag

# Altera MAX V 5M80ZT100C5 TAP
jtag newtap maxv tap -irlen 10 -expected-id 0x020a10dd

# Initialize
init

echo "============================================================"
echo "  CPLD JTAG READY (FINAL CORRECT)"
echo "  Device: Altera MAX V 5M80ZT100C5"
echo "============================================================"
echo ""
echo "GPIO Mapping (VERIFIED):"
echo "  GPIO 23 (Pin 16) -> TMS (Altera PIN 33)"
echo "  GPIO 22 (Pin 15) -> TDI (Altera PIN 34)"
echo "  GPIO 25 (Pin 22) -> TCK (Altera PIN 35)"
echo "  GPIO 24 (Pin 18) -> TDO (Altera PIN 36)"
echo ""
